@startuml
' Стилізація діаграми
skinparam linetype ortho
skinparam monochrome true
skinparam shadowing false
skinparam classAttributeIconSize 0

title Логічна схема реляційної моделі даних (Виправлена)

' --- Основні таблиці ---

entity "users" as users {
  {PK} user_id : INTEGER
  --
  user_name : VARCHAR
  email : VARCHAR
  user_type : VARCHAR
  field_of_study : VARCHAR (nullable)
  department : VARCHAR (nullable)
}

entity "online_discussions" as discussions {
  {PK} discussion_id : INTEGER
  --
  topic : VARCHAR
  creation_date : DATE
}

entity "scientific_ideas" as ideas {
  {PK} idea_id : INTEGER
  --
  {FK} author_id : INTEGER
  {FK} discussion_id : INTEGER
  description : TEXT
  submission_date : DATE
}

entity "comments" as comments {
  {PK} comment_id : INTEGER
  --
  {FK} author_id : INTEGER
  {FK} discussion_id : INTEGER (nullable)
  {FK} idea_id : INTEGER (nullable)
  comment_text : TEXT
  creation_date : DATE
}

entity "shared_documents" as documents {
  {PK} document_id : INTEGER
  --
  {FK} discussion_id : INTEGER
  file_path : VARCHAR
  document_type : VARCHAR
}

entity "online_orders" as orders {
  {PK} order_id : INTEGER
  --
  {FK} scientist_id : INTEGER
  {FK} manager_id : INTEGER (nullable)
  order_date : DATE
  order_status : VARCHAR
}

entity "resources" as resources {
  {PK} resource_id : INTEGER
  --
  title : VARCHAR
  description : TEXT
  resource_type : VARCHAR
  model_number : VARCHAR (nullable)
  author : VARCHAR (nullable)
  publication_year : INTEGER (nullable)
}

' --- Сполучні таблиці (Junction Tables) ---

entity "discussion_participants" as participants {
  {PK} {FK} user_id : INTEGER
  {PK} {FK} discussion_id : INTEGER
}

entity "order_items" as order_items {
  {PK} {FK} order_id : INTEGER
  {PK} {FK} resource_id : INTEGER
  --
  quantity : INTEGER
}


' --- Зв'язки ---

' Зв'язки "Один-до-багатьох"
users               ||--o{ ideas          : "  створює"
users               ||--o{ comments       : "  пише"
users               ||--o{ orders         : "  формує"
users               ||--o{ orders         : "  обробляє"
discussions         ||--|{ ideas          : "  обговорює"
discussions         ||--o{ comments       : "  має"
discussions         ||--o{ documents      : "  має"
ideas               ||--o{ comments       : "  має"

' Зв'язки "Багато-до-багатьох" через сполучні таблиці
users               ||--o{ participants   : " "
discussions         ||--|{ participants   : " "
orders              ||--|{ order_items    : " "
resources           ||--o{ order_items    : " "


@enduml

